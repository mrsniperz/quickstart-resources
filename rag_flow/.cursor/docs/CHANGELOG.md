# 变更日志

## [2025-06-18] 递归分块器功能增强

### 新增 ✨
- **[chunking模块]**: 新增RecursiveCharacterChunker递归字符分块器
  - 实现类似LangChain RecursiveCharacterTextSplitter的多层级递归分割功能
  - 支持多层级分隔符匹配（段落 -> 句子 -> 单词 -> 字符）
  - 支持正则表达式匹配模式
  - 提供可配置的分割优先级和回退机制
  - 智能重叠内容处理和分块大小自适应调整
  *影响范围：增强了文本分割的精度和适应性，特别适用于复杂文档结构的处理。*

- **[chunking模块]**: 新增递归分块器配置选项
  - chunk_size: 目标分块大小配置
  - chunk_overlap: 分块重叠大小配置
  - separators: 自定义分隔符列表
  - is_separator_regex: 正则表达式分隔符支持
  - keep_separator: 分隔符保留选项
  - add_start_index: 起始索引追踪
  - strip_whitespace: 空白字符处理
  *影响范围：为不同类型的文档提供了更灵活的分块配置选项。*

- **[chunking模块]**: 新增递归分块器使用示例
  - example_recursive_usage.py: 完整的使用示例文件
  - 包含基本用法、自定义分隔符、正则表达式和引擎集成示例
  *影响范围：为开发者提供了详细的使用指导和最佳实践。*

### 优化 🚀
- **[chunking模块]**: 优化默认分块策略选择逻辑
  - 将默认策略从'semantic'更改为'recursive'
  - Word文档和纯文本文档优先使用递归分块器
  - 提高了文档分块的整体质量和一致性
  *影响范围：改善了系统的默认行为，提供更好的开箱即用体验。*

- **[chunking模块]**: 增强分块引擎策略注册
  - 自动注册递归分块器为内置策略
  - 更新策略选择算法以支持新的分块器
  *影响范围：简化了递归分块器的使用，无需手动注册。*

### 变更 ⚠️
- **[chunking模块]**: 更新模块导入和接口
  - 在__init__.py中新增RecursiveCharacterChunker导出
  - 更新chunking_engine.py以支持递归分块器注册
  *影响范围：扩展了模块的公共API，保持向后兼容性。*

### 新增 ✨
- **[文档模块]**: 新增分块模块技术分析报告
  - CHUNKING_TECHNICAL_ANALYSIS.md: 详细的技术分析和架构评估
  - 包含架构分析、策略技术实现、性能评估和改进建议
  - 提供了完整的技术决策依据和未来发展规划
  *影响范围：为技术团队提供了深入的技术洞察和决策支持。*

- **[chunking模块]**: 增强README文档内容
  - 新增详细的架构设计说明和策略选择指南
  - 添加了策略对比表和性能分析
  - 提供了完整的使用示例和最佳实践
  - 包含故障排除和调试技巧
  *影响范围：显著提升了模块的可用性和开发者体验。*

## [2025-06-17] 文档处理模块完善与项目文档体系建设

### 新增 ✨
- [Document Processor]: 完善了 docling_parser.py 的功能实现
  *影响范围：增强了文档解析能力，支持更多高级功能如图形导出、表格导出、翻译转换等。*

- [Document Processor]: 创建了完整的模块架构文档
  *影响范围：为 parsers、extractors、chunking、validators 四个子模块创建了详细的 README.md 文档。*

- [Milvus Services]: 分析了 Milvus 模块的整体架构
  *影响范围：深入了解了 collection_manager、data_service、metadata_service、search_service 四个核心服务的功能和协作关系。*

- [项目文档]: 创建了完整的项目文档体系
  *影响范围：创建了 README.md、ARCHITECTURE.md、API_DOC.md、DEPLOYMENT.md 等核心文档。*

### 修复 🐛
- [Document Processor]: 修复了 Docling 导入兼容性问题
  *原因：不同版本的 Docling 库可能缺少某些高级功能模块。*

### 优化 🚀
- [Document Processor]: 优化了 DoclingParser 的错误处理机制
- [Document Processor]: 增加了预设配置功能，支持快速创建不同场景的解析器
- [项目架构]: 完善了模块间的接口设计和数据流定义

### 变更 ⚠️
- [Document Processor]: 重构了 DoclingParser 的初始化方法，增加了更多配置选项
  *影响范围：现有的 DoclingParser 使用代码可能需要更新配置参数。*

- [项目结构]: 建立了标准化的文档结构和编码规范
  *影响范围：所有模块都需要遵循新的文档和代码规范。*

## [2024-12-17] 飞机排故AI专家需求分析与方案增强

### 新增 ✨
- [需求分析]: 完成飞机排故AI专家需求分析与方案对比评估
  *影响范围：识别了现有方案与新需求的差距，制定了详细的优化和补充方案。*

- [故障诊断]: 设计故障诊断模块增强方案
  *影响范围：新增故障推理引擎、贝叶斯网络处理器、交互式诊断系统等核心功能模块。*

- [用户界面]: 制定用户交互界面增强方案
  *影响范围：增加移动端支持、语音输入、OCR识别、可视化输出等功能。*

- [系统集成]: 设计外部系统集成方案
  *影响范围：实现与AMRO、SAP等外部系统的深度集成，包括数据同步和工作流协同。*

### 优化 🚀
- [技术选型]: 补充国产技术解决方案
  *影响范围：优先采用DeepSeek、科大讯飞、PaddleOCR等国产技术方案。*

- [架构设计]: 扩展核心业务层服务组件
  *影响范围：新增故障推理服务、对话管理服务、解释溯源服务、系统集成服务等。*

## [2024-01-15] 文档预处理模块开发完成

### 新增 ✨
- **文档处理/解析器**: 完成多格式文档解析器开发
  - 实现PDF文档处理器，支持PyMuPDF核心解析、表格识别、图像提取、文档结构分析和元数据提取
  - 实现Word文档处理器，支持python-docx解析、格式保持、表格提取和批量处理
  - 实现Excel文档处理器，支持openpyxl多工作表处理、数据提取和表格解析
  - 实现PowerPoint文档处理器，支持python-pptx幻灯片内容提取和备注处理
  - 实现统一文档处理器，提供多格式文档的统一解析接口和自动格式检测
  *影响范围：为整个RAG系统提供了核心的文档处理能力，支持航空行业常见的所有文档格式。*

- **文档处理/分块引擎**: 完成智能分块策略引擎开发
  - 实现分块引擎核心框架，支持多种分块策略的注册和管理
  - 实现航空文档专用分块策略，包括维修手册、规章制度、技术标准、培训资料的专门分块逻辑
  - 实现语义分块器，基于语义相似度和内容连贯性进行智能分块
  - 实现结构分块器，基于文档结构和格式进行分块处理
  - 实现自适应分块参数调整和质量控制机制
  *影响范围：为RAG系统提供了高质量的文档分块能力，特别针对航空行业文档特点进行了优化。*

- **文档处理/内容提取**: 完成内容提取器模块开发
  - 实现元数据提取器，支持文档属性、文件信息、内容统计的全面提取和标准化
  - 实现表格提取器，支持表格数据的解析、格式化和质量控制
  - 实现图像提取器，支持图像信息分析、格式转换和可选OCR功能
  *影响范围：为文档处理流程提供了完整的内容提取能力，支持多模态数据处理。*

- **文档处理/质量控制**: 完成质量控制模块开发
  - 实现分块验证器，提供分块质量控制、完整性验证和优化建议
  - 实现质量控制器，提供文档处理全流程的质量监控和评估
  - 支持多级验证（严格/普通/宽松）和自动质量评分
  *影响范围：确保文档处理质量，为后续的向量化和检索提供高质量的输入数据。*

### 优化 🚀
- **项目结构/模块组织**: 完善了核心模块的目录结构和代码组织
  - 按功能模块清晰划分代码结构
  - 统一了命名规范和注释标准
  - 完善了模块间的依赖关系和接口设计

- **文档/技术文档**: 创建了完整的模块文档
  - 编写了详细的README.md，包含API接口、使用示例和配置说明
  - 提供了完整的代码示例和最佳实践指南
  - 建立了清晰的错误处理和性能优化指南

### 变更 ⚠️
- **依赖管理**: 新增了文档处理相关的第三方库依赖
  - 添加pymupdf、python-docx、openpyxl、python-pptx等核心依赖
  - 添加Pillow等可选依赖用于图像处理
  - 更新了requirements.txt文件

## [2025-06-14]

### 新增 ✨
- **Milvus核心服务模块**: 创建了完整的Milvus核心服务架构
  *影响范围：新增了 `src/core/milvus/` 目录下的三个核心服务模块。*

- **Collection管理服务** (collection_manager.py): 提供Collection的创建、删除、分区管理、索引管理等功能
  *影响范围：支持动态Schema配置和多种数据类型的Collection创建。*

- **检索服务** (search_service.py): 提供向量检索、稀疏向量检索、文本匹配、混合检索等功能
  *影响范围：支持多种检索策略和结果融合算法。*

- **元数据关联服务** (metadata_service.py): 提供元数据补全、复合查询、聚合查询等功能
  *影响范围：支持元数据缓存和复杂查询场景。*

- **数据操作服务** (data_service.py): 提供数据插入、更新、删除、批量操作等功能
  *影响范围：包含从原始代码优化的通用化删除功能，支持智能批量处理和数据验证。*

- **日志管理器重构**: 将SZ_LoggerManager移动到utils目录并增强功能
  *影响范围：提供了更完善的日志配置和管理功能。*

- **详细技术文档**: 创建了完整的README.md技术文档
  *影响范围：包含API参考、使用示例、故障排除指南等详细信息。*

### 优化 🚀
- **代码结构重组**: 按照标准项目结构重新组织代码模块
  *影响范围：提高了代码的可维护性和可扩展性。*

- **模块化设计**: 将原有的单一文件拆分为多个专门的服务模块
  *影响范围：遵循单一职责原则，提高代码质量。*

### 变更 ⚠️
- **项目结构调整**: 创建了标准的核心服务目录结构
  *影响范围：为后续的API重构和功能扩展奠定了基础。*

- **依赖关系优化**: 重新设计了模块间的依赖关系
  *影响范围：降低了模块间的耦合度。*
