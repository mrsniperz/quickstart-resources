# èˆªç©ºRAGç³»ç»Ÿåˆ†å—è´¨é‡è¯„ä¼°æ”¹è¿›æŠ¥å‘Š

## ğŸ“‹ æ‰§è¡Œæ‘˜è¦

æœ¬æŠ¥å‘Šè¯¦ç»†è®°å½•äº†å¯¹èˆªç©ºRAGç³»ç»Ÿæ–‡æ¡£åˆ†å—å¼•æ“è´¨é‡è¯„ä¼°æ–¹æ³•çš„å…¨é¢æ”¹è¿›ã€‚é€šè¿‡æ·±å…¥åˆ†æåŸæœ‰å®ç°çš„ä¸è¶³ï¼Œæˆ‘ä»¬é‡æ–°è®¾è®¡äº†è´¨é‡è¯„ä¼°ä½“ç³»ï¼Œä½¿å…¶æ›´å¥½åœ°é€‚åº”èˆªç©ºæ–‡æ¡£çš„ç‰¹æ®Šéœ€æ±‚å’Œä¸“ä¸šç‰¹æ€§ã€‚

**æ”¹è¿›æˆæœ**ï¼š
- âœ… æ–°å¢5ä¸ªä¸“ä¸šè¯„ä¼°ç»´åº¦
- âœ… å®ç°å·®å¼‚åŒ–æƒé‡é…ç½®
- âœ… å¢å¼ºèˆªç©ºé¢†åŸŸç‰¹å®šæ€§æ£€æŸ¥
- âœ… ä¼˜åŒ–è¯„åˆ†ç®—æ³•é€»è¾‘
- âœ… æ·»åŠ æ™ºèƒ½æƒ©ç½šæœºåˆ¶

---

## ğŸ” åŸæœ‰å®ç°åˆ†æ

### å­˜åœ¨çš„ä¸»è¦é—®é¢˜

1. **ç¼ºå¤±èˆªç©ºé¢†åŸŸç‰¹å®šæ€§**
   - æ²¡æœ‰è€ƒè™‘èˆªç©ºæœ¯è¯­å®Œæ•´æ€§
   - å¿½ç•¥äº†å®‰å…¨ä¿¡æ¯çš„ç‰¹æ®Šé‡è¦æ€§
   - ç¼ºå°‘æ“ä½œæ­¥éª¤è¿è´¯æ€§æ£€æŸ¥

2. **è¯„ä¼°ç»´åº¦ä¸å…¨é¢**
   - åªæœ‰4ä¸ªåŸºç¡€ç»´åº¦ï¼ˆé•¿åº¦ã€å®Œæ•´æ€§ã€å†…å®¹è´¨é‡ã€ç»“æ„ï¼‰
   - æƒé‡åˆ†é…ä¸åˆç†ï¼ˆé•¿åº¦å 30%è¿‡é«˜ï¼‰
   - ç¼ºå°‘ä¿¡æ¯å¯†åº¦è¯„ä¼°

3. **è®¡ç®—é€»è¾‘è¿‡äºç®€å•**
   - çº¿æ€§è¯„åˆ†æ–¹å¼
   - å›ºå®šæƒé‡é…ç½®
   - è¾¹ç•Œæƒ…å†µå¤„ç†ä¸å½“

4. **ä¸æ¨¡å—è®¾è®¡ä¸ä¸€è‡´**
   - æœ‰ä¸“é—¨çš„èˆªç©ºç­–ç•¥ä½†è´¨é‡è¯„ä¼°é€šç”¨åŒ–
   - æ²¡æœ‰åˆ©ç”¨æ–‡æ¡£ç±»å‹ä¿¡æ¯

---

## ğŸš€ æ”¹è¿›æ–¹æ¡ˆè®¾è®¡

### æ–°çš„è¯„ä¼°ç»´åº¦ä½“ç³»

| è¯„ä¼°ç»´åº¦ | æƒé‡èŒƒå›´ | ä¸»è¦åŠŸèƒ½ |
|---------|---------|---------|
| **èˆªç©ºé¢†åŸŸç‰¹å®šæ€§** | 20-30% | æ£€æŸ¥èˆªç©ºæœ¯è¯­ã€å®‰å…¨ä¿¡æ¯ã€æŠ€æœ¯å‚æ•°å®Œæ•´æ€§ |
| **è¯­ä¹‰å®Œæ•´æ€§** | 25-30% | è¯„ä¼°å†…å®¹çš„è¯­ä¹‰è¿è´¯æ€§å’Œå®Œæ•´æ€§ |
| **ä¿¡æ¯å¯†åº¦** | 20-25% | åˆ†ææœ‰æ•ˆä¿¡æ¯å«é‡å’Œå…³é”®è¯å¯†åº¦ |
| **ç»“æ„è´¨é‡** | 20-25% | æ£€æŸ¥æ–‡æ¡£ç»“æ„å’Œæ ¼å¼è§„èŒƒæ€§ |
| **å¤§å°é€‚å½“æ€§** | 5% | è¯„ä¼°åˆ†å—å¤§å°çš„åˆç†æ€§ |

### å·®å¼‚åŒ–æƒé‡é…ç½®

```python
# ç»´ä¿®æ‰‹å†Œ - å¼ºè°ƒèˆªç©ºç‰¹å®šæ€§å’Œæ“ä½œå®‰å…¨
'maintenance_manual': {
    'aviation_specific': 0.30,      # æœ€é«˜æƒé‡
    'semantic_completeness': 0.25,
    'information_density': 0.20,
    'structure_quality': 0.20,
    'size_appropriateness': 0.05
}

# èˆªç©ºæ³•è§„ - å¼ºè°ƒè¯­ä¹‰å®Œæ•´æ€§å’Œç»“æ„
'regulation': {
    'aviation_specific': 0.20,
    'semantic_completeness': 0.30,  # æœ€é«˜æƒé‡
    'information_density': 0.25,
    'structure_quality': 0.20,
    'size_appropriateness': 0.05
}

# æŠ€æœ¯æ ‡å‡† - å¹³è¡¡å„ç»´åº¦
'technical_standard': {
    'aviation_specific': 0.25,
    'semantic_completeness': 0.25,
    'information_density': 0.25,    # æŠ€æœ¯å‚æ•°é‡è¦
    'structure_quality': 0.20,
    'size_appropriateness': 0.05
}

# åŸ¹è®­ææ–™ - å¼ºè°ƒè¯­ä¹‰å’Œç»“æ„
'training_material': {
    'aviation_specific': 0.20,
    'semantic_completeness': 0.30,
    'information_density': 0.20,
    'structure_quality': 0.25,     # æ•™å­¦ç»“æ„é‡è¦
    'size_appropriateness': 0.05
}
```

---

## ğŸ”§ æ ¸å¿ƒæ”¹è¿›å®ç°

### 1. èˆªç©ºé¢†åŸŸç‰¹å®šæ€§è¯„ä¼°

**æ”¹è¿›å‰**ï¼š
```python
# ç®€å•çš„å…³é”®è¯åŒ¹é…
if any(marker in content for marker in ['#', '##', '###', 'ç¬¬', 'ç« ', 'èŠ‚', 'æ¡']):
    structure_score += 0.2
```

**æ”¹è¿›å**ï¼š
```python
def _calculate_aviation_specific_score(self, chunk: TextChunk) -> float:
    score = 0.5  # ä»è¾ƒä½åŸºç¡€åˆ†å¼€å§‹
    
    # èˆªç©ºæœ¯è¯­å¯†åº¦æ£€æŸ¥
    aviation_term_count = sum(1 for term in aviation_terms if term in content)
    if aviation_term_count > 0:
        score += min(0.3, aviation_term_count * 0.1)
    
    # æœ¯è¯­æˆªæ–­æ£€æŸ¥
    for term in aviation_terms:
        if content.startswith(term[1:]) or content.endswith(term[:-1]):
            score -= 0.3  # ä¸¥é‡æ‰£åˆ†
    
    # å®‰å…¨ä¿¡æ¯å®Œæ•´æ€§
    if safety_found:
        score += 0.2
        if not self._is_safety_info_complete(chunk.content):
            score -= 0.4  # ä¸¥é‡æ‰£åˆ†
    
    # æ“ä½œæ­¥éª¤è¿è´¯æ€§
    if has_steps:
        score += 0.2
        if self._has_incomplete_procedures(chunk.content):
            score -= 0.3
    
    return max(0.0, min(1.0, score))
```

### 2. æ™ºèƒ½æƒ©ç½šæœºåˆ¶

```python
# å¯¹æ˜æ˜¾æœ‰é—®é¢˜çš„å†…å®¹åº”ç”¨æƒ©ç½š
penalty = 0.0

# å†…å®¹è¿‡çŸ­æƒ©ç½š
if chunk.character_count < 30:
    penalty += 0.4
elif chunk.character_count < 50:
    penalty += 0.2

# ç©ºç™½å­—ç¬¦è¿‡å¤šæƒ©ç½š
non_space_ratio = len(chunk.content.replace(' ', '').replace('\n', '').replace('\t', '')) / len(chunk.content)
if non_space_ratio < 0.3:
    penalty += 0.5
elif non_space_ratio < 0.5:
    penalty += 0.3

# ä¿ç•™æœ€ä½åˆ†æ•°
final_score = max(0.1, total_score - penalty)
```

### 3. å¢å¼ºçš„å®‰å…¨ä¿¡æ¯æ£€æŸ¥

```python
def _is_safety_info_complete(self, content: str) -> bool:
    for pattern in safety_start_patterns:
        if pattern in content:
            after_warning = content[start_idx + len(pattern):].strip()
            
            # æ›´ä¸¥æ ¼çš„å®Œæ•´æ€§æ£€æŸ¥
            if len(after_warning) < 20:  # æé«˜æœ€å°é•¿åº¦è¦æ±‚
                return False
            
            # æ£€æŸ¥å¥å­ç»“æ„å®Œæ•´æ€§
            if not any(after_warning.endswith(end) for end in ['.', 'ã€‚', '!', 'ï¼']):
                return False
            
            # æ£€æŸ¥å®‰å…¨æªæ–½æè¿°
            safety_action_keywords = ['å¿…é¡»', 'ç¦æ­¢', 'åº”è¯¥', 'ä¸å¾—', 'must', 'should', 'do not', 'never']
            if not any(keyword in after_warning for keyword in safety_action_keywords):
                return False
    
    return True
```

---

## ğŸ“Š æµ‹è¯•éªŒè¯ç»“æœ

### æµ‹è¯•ç”¨ä¾‹è®¾è®¡

æˆ‘ä»¬è®¾è®¡äº†6ä¸ªå…¸å‹çš„èˆªç©ºæ–‡æ¡£åˆ†å—æµ‹è¯•ç”¨ä¾‹ï¼š

1. **å®Œæ•´çš„ç»´ä¿®æ­¥éª¤** - é¢„æœŸé«˜åˆ† (0.8-1.0)
2. **ä¸å®Œæ•´çš„å®‰å…¨è­¦å‘Š** - é¢„æœŸä¸­ä½åˆ† (0.4-0.7)
3. **æŠ€æœ¯å‚æ•°åˆ—è¡¨** - é¢„æœŸä¸­é«˜åˆ† (0.6-0.8)
4. **æˆªæ–­çš„èˆªç©ºæœ¯è¯­** - é¢„æœŸä½åˆ† (0.3-0.6)
5. **å®Œæ•´çš„èˆªç©ºæ³•è§„** - é¢„æœŸé«˜åˆ† (0.8-1.0)
6. **ç©ºç™½å†…å®¹è¿‡å¤š** - é¢„æœŸä½åˆ† (0.1-0.4)

### æµ‹è¯•ç»“æœ

```
ğŸ“Š æµ‹è¯•ç”¨ä¾‹æ€»æ•°: 6
é€šè¿‡æµ‹è¯•: 4/6 (66.7%)
âš ï¸  è´¨é‡è¯„ä¼°æœ‰æ‰€æ”¹è¿›ï¼Œä½†ä»éœ€ä¼˜åŒ–
```

**è¯¦ç»†ç»“æœåˆ†æ**ï¼š
- âœ… å®Œæ•´çš„ç»´ä¿®æ­¥éª¤ï¼š0.969 (é€šè¿‡)
- âœ… ä¸å®Œæ•´çš„å®‰å…¨è­¦å‘Šï¼š0.607 (é€šè¿‡)
- âŒ æŠ€æœ¯å‚æ•°åˆ—è¡¨ï¼š0.834 (è¶…å‡ºé¢„æœŸä¸Šé™)
- âŒ æˆªæ–­çš„èˆªç©ºæœ¯è¯­ï¼š0.719 (è¶…å‡ºé¢„æœŸä¸Šé™)
- âœ… å®Œæ•´çš„èˆªç©ºæ³•è§„ï¼š0.948 (é€šè¿‡)
- âœ… ç©ºç™½å†…å®¹è¿‡å¤šï¼š0.100 (é€šè¿‡)

---

## ğŸ¯ æ”¹è¿›æ•ˆæœè¯„ä¼°

### ä¸»è¦æˆå°±

1. **ä¸“ä¸šæ€§æ˜¾è‘—æå‡**
   - æ–°å¢èˆªç©ºé¢†åŸŸç‰¹å®šæ€§è¯„ä¼°ç»´åº¦
   - å®ç°äº†å¯¹èˆªç©ºæœ¯è¯­ã€å®‰å…¨ä¿¡æ¯çš„ä¸“ä¸šæ£€æŸ¥
   - æ”¯æŒæ“ä½œæ­¥éª¤è¿è´¯æ€§éªŒè¯

2. **è¯„ä¼°ç²¾åº¦æé«˜**
   - ä»4ä¸ªç»´åº¦æ‰©å±•åˆ°5ä¸ªç»´åº¦
   - å®ç°å·®å¼‚åŒ–æƒé‡é…ç½®
   - å¢åŠ æ™ºèƒ½æƒ©ç½šæœºåˆ¶

3. **ç³»ç»Ÿä¸€è‡´æ€§æ”¹å–„**
   - ä¸èˆªç©ºåˆ†å—ç­–ç•¥è®¾è®¡ä¿æŒä¸€è‡´
   - å……åˆ†åˆ©ç”¨æ–‡æ¡£ç±»å‹å…ƒæ•°æ®
   - æ”¯æŒé…ç½®åŒ–å®šåˆ¶

4. **è¾¹ç•Œæƒ…å†µå¤„ç†ä¼˜åŒ–**
   - æ›´ä¸¥æ ¼çš„å†…å®¹è´¨é‡æ£€æŸ¥
   - æ™ºèƒ½çš„å¼‚å¸¸æƒ…å†µå¤„ç†
   - åˆç†çš„æœ€ä½åˆ†æ•°ä¿æŠ¤

### å¾…ä¼˜åŒ–æ–¹å‘

1. **è¯„åˆ†æ ¡å‡†**
   - éƒ¨åˆ†æµ‹è¯•ç”¨ä¾‹è¯„åˆ†åé«˜
   - éœ€è¦è¿›ä¸€æ­¥è°ƒæ•´è¯„åˆ†é˜ˆå€¼
   - å¯è€ƒè™‘å¼•å…¥æœºå™¨å­¦ä¹ ä¼˜åŒ–

2. **è§„åˆ™å®Œå–„**
   - å¢åŠ æ›´å¤šèˆªç©ºä¸“ä¸šæœ¯è¯­
   - å®Œå–„å®‰å…¨ä¿¡æ¯è¯†åˆ«è§„åˆ™
   - ä¼˜åŒ–æŠ€æœ¯å‚æ•°æ£€æŸ¥é€»è¾‘

3. **æ€§èƒ½ä¼˜åŒ–**
   - ç¼“å­˜å¸¸ç”¨è®¡ç®—ç»“æœ
   - ä¼˜åŒ–æ­£åˆ™è¡¨è¾¾å¼æ€§èƒ½
   - å‡å°‘é‡å¤è®¡ç®—

---

## ğŸ“ˆ ä¸šåŠ¡ä»·å€¼

### ç›´æ¥ä»·å€¼

1. **æé«˜æ£€ç´¢è´¨é‡**
   - æ›´å‡†ç¡®çš„åˆ†å—è´¨é‡è¯„ä¼°
   - æ›´å¥½çš„èˆªç©ºæ–‡æ¡£é€‚é…æ€§
   - æå‡RAGç³»ç»Ÿæ•´ä½“æ€§èƒ½

2. **å¢å¼ºç³»ç»Ÿå¯é æ€§**
   - å‡å°‘ä½è´¨é‡åˆ†å—çš„å½±å“
   - æé«˜å®‰å…¨ä¿¡æ¯å¤„ç†å‡†ç¡®æ€§
   - ä¿è¯å…³é”®ä¿¡æ¯å®Œæ•´æ€§

3. **æ”¯æŒä¸šåŠ¡æ‰©å±•**
   - å¯é…ç½®çš„è¯„ä¼°ä½“ç³»
   - æ”¯æŒæ–°æ–‡æ¡£ç±»å‹æ‰©å±•
   - ä¾¿äºåç»­ä¼˜åŒ–è¿­ä»£

### é•¿æœŸä»·å€¼

1. **å»ºç«‹è¡Œä¸šæ ‡å‡†**
   - ä¸ºèˆªç©ºæ–‡æ¡£å¤„ç†æä¾›å‚è€ƒ
   - æ¨åŠ¨è¡Œä¸šæŠ€æœ¯æ ‡å‡†åŒ–
   - ç§¯ç´¯ä¸“ä¸šé¢†åŸŸç»éªŒ

2. **æŠ€æœ¯èƒ½åŠ›æå‡**
   - æ·±åŒ–å¯¹èˆªç©ºé¢†åŸŸçš„ç†è§£
   - æå‡AIç³»ç»Ÿä¸“ä¸šåŒ–æ°´å¹³
   - ä¸ºå…¶ä»–å‚ç›´é¢†åŸŸæä¾›å€Ÿé‰´

---

## ğŸ”® åç»­è§„åˆ’

### çŸ­æœŸè®¡åˆ’ (1-2å‘¨)

1. **è¯„åˆ†æ ¡å‡†ä¼˜åŒ–**
   - æ”¶é›†æ›´å¤šçœŸå®èˆªç©ºæ–‡æ¡£æ ·æœ¬
   - è°ƒæ•´è¯„åˆ†é˜ˆå€¼å’Œæƒé‡
   - å®Œå–„æµ‹è¯•ç”¨ä¾‹è¦†ç›–

2. **è§„åˆ™åº“æ‰©å±•**
   - å¢åŠ èˆªç©ºæœ¯è¯­è¯å…¸
   - å®Œå–„å®‰å…¨ä¿¡æ¯æ¨¡å¼
   - ä¼˜åŒ–æŠ€æœ¯å‚æ•°è¯†åˆ«

### ä¸­æœŸè®¡åˆ’ (1-2æœˆ)

1. **æ€§èƒ½ä¼˜åŒ–**
   - å®ç°è®¡ç®—ç»“æœç¼“å­˜
   - ä¼˜åŒ–ç®—æ³•å¤æ‚åº¦
   - æå‡å¤„ç†é€Ÿåº¦

2. **åŠŸèƒ½å¢å¼º**
   - æ”¯æŒå¤šè¯­è¨€èˆªç©ºæ–‡æ¡£
   - å¢åŠ å›¾è¡¨å¼•ç”¨æ£€æŸ¥
   - å®ç°è´¨é‡è¶‹åŠ¿åˆ†æ

### é•¿æœŸè®¡åˆ’ (3-6æœˆ)

1. **æ™ºèƒ½åŒ–å‡çº§**
   - å¼•å…¥æœºå™¨å­¦ä¹ æ¨¡å‹
   - å®ç°è‡ªé€‚åº”æƒé‡è°ƒæ•´
   - æ”¯æŒä¸ªæ€§åŒ–é…ç½®

2. **ç”Ÿæ€å»ºè®¾**
   - å¼€å‘è´¨é‡è¯„ä¼°å·¥å…·
   - å»ºç«‹è¯„ä¼°æ ‡å‡†æ–‡æ¡£
   - æ¨å¹¿æœ€ä½³å®è·µ

---

## ğŸ“ æ€»ç»“

é€šè¿‡æœ¬æ¬¡æ”¹è¿›ï¼Œæˆ‘ä»¬æˆåŠŸåœ°å°†é€šç”¨çš„æ–‡æ¡£åˆ†å—è´¨é‡è¯„ä¼°æ–¹æ³•å‡çº§ä¸ºä¸“é—¨é€‚é…èˆªç©ºRAGç³»ç»Ÿçš„ä¸“ä¸šè¯„ä¼°ä½“ç³»ã€‚æ–°çš„è¯„ä¼°æ–¹æ³•ä¸ä»…è€ƒè™‘äº†èˆªç©ºæ–‡æ¡£çš„ç‰¹æ®Šæ€§ï¼Œè¿˜å®ç°äº†å·®å¼‚åŒ–çš„é…ç½®æ”¯æŒï¼Œä¸ºåç»­çš„ç³»ç»Ÿä¼˜åŒ–å¥ å®šäº†åšå®åŸºç¡€ã€‚

è™½ç„¶åœ¨æµ‹è¯•ä¸­å‘ç°äº†ä¸€äº›éœ€è¦è¿›ä¸€æ­¥è°ƒä¼˜çš„åœ°æ–¹ï¼Œä½†æ•´ä½“æ”¹è¿›æ–¹å‘æ­£ç¡®ï¼Œæ•ˆæœæ˜¾è‘—ã€‚æˆ‘ä»¬å°†ç»§ç»­æ ¹æ®å®é™…ä½¿ç”¨åé¦ˆï¼ŒæŒç»­ä¼˜åŒ–å’Œå®Œå–„è¿™å¥—è´¨é‡è¯„ä¼°ä½“ç³»ã€‚

---

**æ–‡æ¡£ä¿¡æ¯**
- åˆ›å»ºæ—¥æœŸ: 2024-01-15
- ä½œè€…: Sniperz  
- ç‰ˆæœ¬: v1.0.0
- æœ€åæ›´æ–°: 2024-01-15
